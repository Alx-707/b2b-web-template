{
  "tasks": [
    {
      "id": "d70d6366-b27a-43dd-b507-e91f1dd58aaf",
      "name": "建立架构度量基线脚本",
      "description": "开发scripts/architecture-metrics.js统一度量脚本，统计export *数量、类型文件数、i18n文件数、TypeScript/ESLint错误数。集成到CI pipeline，每次构建自动生成度量报告，建立可追踪的重构进度基线。",
      "notes": "基于现有scripts目录结构，复用quality-monitor.js的报告生成模式",
      "status": "completed",
      "dependencies": [],
      "createdAt": "2025-09-11T16:01:37.317Z",
      "updatedAt": "2025-09-11T16:01:37.317Z",
      "relatedFiles": [
        {
          "path": "scripts/quality-monitor.js",
          "type": "REFERENCE",
          "description": "参考现有质量监控脚本的实现模式"
        },
        {
          "path": "package.json",
          "type": "TO_MODIFY",
          "description": "添加architecture:metrics命令"
        },
        {
          "path": "scripts/architecture-metrics.js",
          "type": "CREATE",
          "description": "新建架构度量脚本"
        }
      ],
      "implementationGuide": "1. 创建scripts/architecture-metrics.js脚本\\n2. 使用glob模式扫描src/lib目录统计文件数量\\n3. 解析TypeScript和ESLint输出获取错误统计\\n4. 生成JSON格式度量报告到reports/architecture/\\n5. 集成到package.json的ci:quality命令中\\n6. 配置GitHub Actions自动执行和报告存储",
      "verificationCriteria": "生成完整基线报告包含所有关键指标，CI集成成功，报告格式符合项目标准",
      "analysisResult": "tucsenberg-web-frontier架构重构项目：三阶段系统性重构，解决export *泛滥（97个→<30）、文件过度细分（644个→~300）、类型文件分散等问题。目标实现TypeScript错误从2,759降至0，ESLint问题从2,075降至<200，提升构建性能20-30%，IDE响应速度40-50%，开发效率50%+。项目采用小步快跑策略，每次PR限制300-600行代码改动，通过过渡期兼容层确保零风险迁移。基于现有优秀工具基础设施（dependency-cruiser、ESLint严格配置、质量监控脚本），充分重用避免重复建设。"
    },
    {
      "id": "e9907aaa-9804-4182-8f82-6e6c6cc23472",
      "name": "增强dependency-cruiser跨域规则",
      "description": "在现有.dependency-cruiser.js基础上添加跨域直连禁止规则，配置src/lib各功能域边界规则，仅允许通过公开API访问，禁止相对路径跨层导入。",
      "notes": "基于现有完善的dependency-cruiser配置，仅增强跨域规则，保持现有架构检查功能",
      "status": "completed",
      "dependencies": [],
      "createdAt": "2025-09-11T16:01:37.317Z",
      "updatedAt": "2025-09-11T16:01:37.317Z",
      "relatedFiles": [
        {
          "path": ".dependency-cruiser.js",
          "type": "TO_MODIFY",
          "description": "添加跨域直连禁止规则"
        },
        {
          "path": "docs/architecture/dependency-rules.md",
          "type": "TO_MODIFY",
          "description": "更新依赖规则文档"
        }
      ],
      "implementationGuide": "1. 分析现有.dependency-cruiser.js的6项规则\\n2. 添加no-cross-domain-direct-imports规则\\n3. 配置i18n、locale-storage、security、whatsapp等域边界\\n4. 设置pathNot例外允许访问utils、types、index\\n5. 测试规则有效性，确保零false positive\\n6. 更新文档说明新增规则用途",
      "verificationCriteria": "arch:check命令能检测跨域违规，现有合法导入不受影响，新规则文档完整",
      "analysisResult": "tucsenberg-web-frontier架构重构项目：三阶段系统性重构，解决export *泛滥（97个→<30）、文件过度细分（644个→~300）、类型文件分散等问题。目标实现TypeScript错误从2,759降至0，ESLint问题从2,075降至<200，提升构建性能20-30%，IDE响应速度40-50%，开发效率50%+。项目采用小步快跑策略，每次PR限制300-600行代码改动，通过过渡期兼容层确保零风险迁移。基于现有优秀工具基础设施（dependency-cruiser、ESLint严格配置、质量监控脚本），充分重用避免重复建设。"
    },
    {
      "id": "d8930e4f-a6e9-42ae-9351-20565925c549",
      "name": "开发export *转换codemod脚本",
      "description": "基于@babel/parser和@babel/traverse开发scripts/transform-barrel-exports.js，自动将export *转换为命名导出，保持功能等价性，支持批量处理和增量转换。",
      "notes": "参考现有translation-scanner.js的AST解析模式，确保转换的安全性和准确性",
      "status": "completed",
      "dependencies": [],
      "createdAt": "2025-09-11T16:01:37.317Z",
      "updatedAt": "2025-09-11T16:01:37.317Z",
      "relatedFiles": [
        {
          "path": "scripts/translation-scanner.js",
          "type": "REFERENCE",
          "description": "参考AST解析和文件处理模式"
        },
        {
          "path": "scripts/transform-barrel-exports.js",
          "type": "CREATE",
          "description": "新建export *转换脚本"
        },
        {
          "path": "package.json",
          "type": "TO_MODIFY",
          "description": "添加codemod:barrel命令"
        }
      ],
      "implementationGuide": "1. 安装@babel/parser、@babel/traverse依赖\\n2. 创建AST解析逻辑识别export * from语句\\n3. 分析目标模块的具体导出内容\\n4. 生成等价的命名导出语句\\n5. 实现文件批量处理和备份机制\\n6. 添加dry-run模式预览变更\\n7. 集成到package.json作为codemod:barrel命令",
      "verificationCriteria": "能正确转换测试用例，保持导入导出功能一致，支持批量处理和回滚",
      "analysisResult": "tucsenberg-web-frontier架构重构项目：三阶段系统性重构，解决export *泛滥（97个→<30）、文件过度细分（644个→~300）、类型文件分散等问题。目标实现TypeScript错误从2,759降至0，ESLint问题从2,075降至<200，提升构建性能20-30%，IDE响应速度40-50%，开发效率50%+。项目采用小步快跑策略，每次PR限制300-600行代码改动，通过过渡期兼容层确保零风险迁移。基于现有优秀工具基础设施（dependency-cruiser、ESLint严格配置、质量监控脚本），充分重用避免重复建设。"
    },
    {
      "id": "19e372bf-ffd5-49d2-b265-37b6dc5acc5e",
      "name": "配置ESLint禁止新增export *规则",
      "description": "在现有eslint.config.mjs基础上添加no-export-star自定义规则，仅对新代码生效，集成到pre-commit hooks，防止新增export *重新导出。",
      "notes": "基于现有严格的ESLint配置，仅添加export *限制，不影响现有重构计划",
      "status": "completed",
      "dependencies": [],
      "createdAt": "2025-09-11T16:01:37.317Z",
      "updatedAt": "2025-09-11T16:01:37.317Z",
      "relatedFiles": [
        {
          "path": "eslint.config.mjs",
          "type": "TO_MODIFY",
          "description": "添加no-export-star规则到ultra-strict-quality-config"
        },
        {
          "path": "lefthook.yml",
          "type": "REFERENCE",
          "description": "确认pre-commit hooks集成"
        }
      ],
      "implementationGuide": "1. 分析现有505行ESLint配置结构\\n2. 在ultra-strict-quality-config中添加no-restricted-syntax规则\\n3. 配置禁止ExportAllDeclaration AST节点\\n4. 设置合理的例外情况（如index.ts统一导出）\\n5. 测试规则对现有代码的影响\\n6. 确保lefthook pre-commit集成正常",
      "verificationCriteria": "新增export *会被ESLint阻止，现有代码不受影响，pre-commit集成正常",
      "analysisResult": "tucsenberg-web-frontier架构重构项目：三阶段系统性重构，解决export *泛滥（97个→<30）、文件过度细分（644个→~300）、类型文件分散等问题。目标实现TypeScript错误从2,759降至0，ESLint问题从2,075降至<200，提升构建性能20-30%，IDE响应速度40-50%，开发效率50%+。项目采用小步快跑策略，每次PR限制300-600行代码改动，通过过渡期兼容层确保零风险迁移。基于现有优秀工具基础设施（dependency-cruiser、ESLint严格配置、质量监控脚本），充分重用避免重复建设。"
    },
    {
      "id": "fix-import-type-issues",
      "name": "修复verbatimModuleSyntax导致的import type问题",
      "description": "修复启用verbatimModuleSyntax后暴露的大量import type问题，批量转换需要使用import type的导入语句，减少TypeScript错误数量。",
      "notes": "已修复41个文件的import type问题和4个_error属性错误，但仍有其他TypeScript错误需要处理",
      "status": "completed",
      "dependencies": [],
      "createdAt": "2025-09-11T16:30:00.000Z",
      "updatedAt": "2025-09-12T00:00:00.000Z",
      "relatedFiles": [
        {
          "path": "src/",
          "type": "TO_MODIFY",
          "description": "批量修复import type问题"
        }
      ],
      "implementationGuide": "1. 运行TypeScript编译器获取详细错误信息\\n2. 识别需要使用import type的导入语句\\n3. 批量转换为import type语法\\n4. 验证TypeScript错误数量显著减少",
      "verificationCriteria": "TypeScript错误数量从2908减少到2500以下，编译通过"
    },
    {
      "id": "332c9831-fc3e-4b70-81cf-a499f0454034",
      "name": "团队重构流程培训对齐",
      "description": "制作重构流程文档和最佳实践指南，组织团队培训会，建立代码审查checklist和质量门禁标准，确保团队理解小步快跑策略和过渡期兼容层。",
      "notes": "已创建完整的重构文档体系：README.md、best-practices.md、code-review-checklist.md，并更新项目README",
      "status": "completed",
      "dependencies": [],
      "createdAt": "2025-09-11T16:01:37.317Z",
      "updatedAt": "2025-09-11T16:01:37.317Z",
      "relatedFiles": [
        {
          "path": "docs/refactoring/",
          "type": "CREATE",
          "description": "新建重构流程文档目录"
        },
        {
          "path": "README.md",
          "type": "TO_MODIFY",
          "description": "添加重构指南链接"
        },
        {
          "path": "docs/architecture/",
          "type": "REFERENCE",
          "description": "参考现有架构文档格式"
        }
      ],
      "implementationGuide": "1. 创建docs/refactoring/目录结构\\n2. 编写重构流程指南和最佳实践文档\\n3. 制作小步快跑策略和过渡期兼容层说明\\n4. 建立代码审查checklist模板\\n5. 准备团队培训材料和演示用例\\n6. 组织培训会议并收集反馈\\n7. 更新项目README添加重构指南链接",
      "verificationCriteria": "团队成员理解重构流程，能独立执行任务，代码审查checklist可用",
      "analysisResult": "tucsenberg-web-frontier架构重构项目：三阶段系统性重构，解决export *泛滥（97个→<30）、文件过度细分（644个→~300）、类型文件分散等问题。目标实现TypeScript错误从2,759降至0，ESLint问题从2,075降至<200，提升构建性能20-30%，IDE响应速度40-50%，开发效率50%+。项目采用小步快跑策略，每次PR限制300-600行代码改动，通过过渡期兼容层确保零风险迁移。基于现有优秀工具基础设施（dependency-cruiser、ESLint严格配置、质量监控脚本），充分重用避免重复建设。"
    }
  ]
}